---
Title: "Gen Xen"
Description: "Gen Xen"
Tags: ["cloud","configuration management","perl","programming","virtualization","xen"]
Date: "2011-10-10"
Categories:
  - "blog"
Slug: "genxen"
---
<p><img alt="" width="600" src="http://www.just-marvel-x-men.com/image-files/astonishing-x-men-1-100k.jpg" title="Xen" class="alignnone"  /></p><p>I've been working pretty extensively with Xen and Puppet in my new job, really loving it! I've been creating a whole load of Xen hosts, most of which are cloned from an initial image I built using Xen-tools. I've just finished a script which is over on <a href="https://github.com/sideb0ard/GenXen" title="GitHub" target="_blank">my github page</a>, which basically automates what was previously a manual process.</p><p>Basically, it copies your existing disk.img and swap.img, generates a new xen.cfg file based on some interactive input (desired hostname, IP, memory and number of vCPUs) plus a random Xen mac address, then mounts the disk.img file and changes some appropriate system files - /etc/hostname, hosts, and network/interfaces.</p><p>All quite simple and straight forward, but quite nice to have automated.</p><p><a href="https://github.com/sideb0ard/GenXen" title="GenXen" target="_blank">GenXen</a></p><p>Here's the README:</p><p>GenXen #<br />#############################</p><p>A script for automating Xen VM deployment.</p><p>It requires that you have a base disk.img and swap.img already created.<br />I created mine with:<br />xen-create-image -pygrub -size=50Gb -swap=9Gb -vcpus=2 -memory 6Gb -dist=squeeze -dhcp -passwd -dir=/var/virt-machines -hostname=xen-squeeze-base</p><p>Fill in some of the variables at the top of GenXen.pl before running, then simply:<br />./GenXen.pl</p><p>The interactive part will ask for hostname, memory size, vCPUs, IP address, then generate a unique Xen mac address, and write these all to a xen config file which will be saved in /etc/xen/</p><p>It'll copy your disk.img and swap.img to destination dir, mount the disk.img and create appropriate files for:<br />/etc/hostname<br />/etc/hosts<br />/etc/network/interfaces </p><p>After that you should be good to launch with:</p><p>xm create -c /etc/xen/whatever-your-hostname-is.cfg</p>
